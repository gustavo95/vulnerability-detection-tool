package security.br.ufal.ic.moodle;

import java.io.IOException;
import java.util.ArrayList;
import java.util.List;

import javax.persistence.Column;
import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;
import javax.persistence.Table;

@Table(name = "DiffMoodle")
@Entity
public class DiffMoodle {
	
	@Id
	@GeneratedValue(strategy = GenerationType.IDENTITY)
	private int id;
	
	private List<String> diffs;
	
    @Column(name = "diff")
	private String diff;
    
    @Column(name = "files")
    private List<FileMoodle> files;
    
    
	public DiffMoodle(){
		this.diffs = new ArrayList<String>();
		this.files = new ArrayList<FileMoodle>();
	}
	
	public List<String> getDiffs() throws IOException{
		List<String> logs = new LogsMoodle().getLogs();
		for(int i = 0; i < logs.size()-1; i++){
			String diff = ColetarFluxo.execCommand("git diff " + logs.get(i) + " " + logs.get(i+1));
			System.out.println(i);
			diffs.add(diff);
		}
		return diffs;
	}

	public int getId() {
		return id;
	}

	public void setId(int id) {
		this.id = id;
	}

	public String getDiff() {
		return diff;
	}

	public void setDiff(String diff) {
		this.diff = diff;
	}

	public List<FileMoodle> getFiles() {
		return files;
	}

	public void setFiles(List<FileMoodle> files) {
		this.files = files;
	}

	public void setDiffs(List<String> diffs) {
		this.diffs = diffs;
	}
	
	
}