library(DBI)
library(lattice)
library(Hmisc)
library(dplyr)
library(RMySQL)
library(plotrix)
library(reshape2)
library(unbalanced)
con <- dbConnect(MySQL(), user = 'root', password = 'admin', host = 'localhost', dbname='changehistory')
#vetorPaths <- c("dom","javascript","javascript_extras","javascript_xpconnect","layout_rendering","libraries","kernel","network","webpage_structure","widget")
#for(i in vetorPaths){      
querryTable="kernelClassify"
querryBefore="SELECT func,cveID, module, vulnerability,vulnerabilitytype, SUM(NCEC),SUM(NCMC),SUM(NFCEC),SUM(NFCMC),SUM(NMEC),SUM(NMMC),SUM(NVEC),SUM(NVMC) FROM "
querryAfter=" GROUP BY func,file_path,vulnerabilitytype,module;"
kernelclassify <- dbGetQuery(con,paste(querryBefore,querryTable,querryAfter,sep=""))


kernel_vulnerabilities <- subset(kernelclassify,vulnerability == 1)

kernel_without_vulnerabilities <- subset(kernelclassify,vulnerability == 0)

n<-ncol(kernelclassify)

#output<-kernelclassify$vulnerability
kernelclassify$vulnerability<-factor(ifelse(kernelclassify$vulnerability==1,0,no=FALSE))
output<-kernelclassify$vulnerability
input<-kernelclassify[,-n]
input
kernelclassify<-ubSMOTE(X= input, Y=output, perc.over = 200, k = 5, perc.under = 200, verbose = TRUE)
newData<-cbind(kernelclassify$X, kernelclassify$Y)
newData


dbDisconnect(con)
