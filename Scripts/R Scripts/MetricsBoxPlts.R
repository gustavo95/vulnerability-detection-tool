library(DBI)
library(lattice)
library(Hmisc)
library(dplyr)
library(RMySQL)
library(plotrix)

con <- dbConnect(MySQL(), user = 'root', password = 'admin', host = 'localhost', dbname='changehistory')
#vetorPaths <- c("dom","javascript","javascript_extras","javascript_xpconnect","layout_rendering","libraries","kernel","network","webpage_structure","widget")
#for(i in vetorPaths){      
querryTable="kernelClassify"
querryBefore="SELECT func,cveID, module, vulnerability, SUM(NCEC),SUM(NCMC),SUM(NFCEC),SUM(NFCMC),SUM(NMEC),SUM(NMMC),SUM(NVEC),SUM(NVMC) FROM "
querryAfter=" GROUP BY func,file_path,CVEID,module;"
kernelclassify <- dbGetQuery(con,paste(querryBefore,querryTable,querryAfter,sep=""))


kernel_vulnerabilities <- subset(kernelclassify,vulnerability == 1)

kernel_without_vulnerabilities <- subset(kernelclassify,vulnerability == 0)


querryTable="mozillaClassify"
querryBefore="SELECT func,cveID, module, vulnerability, SUM(NCEC),SUM(NCMC),SUM(NFCEC),SUM(NFCMC),SUM(NMEC),SUM(NMMC),SUM(NVEC),SUM(NVMC) FROM "
querryAfter=" GROUP BY func,file_path,CVEID,module;"
mozillaclassify <- dbGetQuery(con,paste(querryBefore,querryTable,querryAfter,sep=""))


mozilla_vulnerabilities <- subset(mozillaclassify,vulnerability == 1)

mozilla_without_vulnerabilities <- subset(mozillaclassify,vulnerability == 0)




mat <- cbind(k_nec = kernel_vulnerabilities[,5], k_nec=kernel_without_vulnerabilities[,5],
             k_nmc = kernel_vulnerabilities[,6], k_nmc=kernel_without_vulnerabilities[,6],m_nec = mozilla_vulnerabilities[,5], m_nec=mozilla_without_vulnerabilities[,5],
             m_nmc = mozilla_vulnerabilities[,6], m_nmc=mozilla_without_vulnerabilities[,6])
boxplot(as.data.frame(mat),main = "",outline = FALSE,cex.axis=1,cex.names=1, col = c("grey", "white","grey", "white","grey", "white","grey", "white"))
legend(1, 55, c("V", "NV"),
       fill = c("grey", "white"))





#}
dbDisconnect(con)
